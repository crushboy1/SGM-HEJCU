<div class="form-deuda-economica bg-white rounded-xl shadow-md border border-gray-200 p-6">

  <div class="flex items-center gap-3 mb-6 pb-4 border-b border-gray-200">
    <div class="p-3 bg-cyan-100 rounded-xl">
      <app-icon name="credit-card" [size]="24" class="text-hospital-cyan"></app-icon>
    </div>
    <div>
      <h3 class="text-lg font-bold text-gray-800">{{ tituloFormulario }}</h3>
      <p class="text-sm text-gray-500">Registre deuda hospitalaria pendiente</p>
    </div>
  </div>

  <form (ngSubmit)="registrar()" class="space-y-5">

    <div>
      <label for="ecoExpedienteId" class="block text-sm font-semibold text-gray-700 mb-2">
        <app-icon name="hash" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
        ID Expediente *
      </label>
      <input type="number"
             id="ecoExpedienteId"
             name="ecoExpedienteId"
             [(ngModel)]="formData.expedienteId"
             (input)="clearError('expedienteId')"
             [readonly]="expedienteReadonly"
             [class.bg-gray-100]="expedienteReadonly"
             [class.cursor-not-allowed]="expedienteReadonly"
             min="1"
             required
             placeholder="Ej: 12345"
             class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all"
             [ngClass]="errors.expedienteId ? 'border-red-500' : 'border-gray-300'" />

      <p *ngIf="errors.expedienteId" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
        <app-icon name="circle-x" [size]="14"></app-icon>
        {{ errors.expedienteId }}
      </p>

      <p *ngIf="codigoExpediente && !errors.expedienteId" class="mt-1.5 text-sm text-gray-500">
        Asociado a: <span class="font-mono font-semibold text-hospital-blue">{{ codigoExpediente }}</span>
      </p>
    </div>

    <div>
      <label for="montoDeuda" class="block text-sm font-semibold text-gray-700 mb-2">
        <app-icon name="bar-chart" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
        Monto Total (S/.) *
      </label>

      <div class="relative">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <span class="text-gray-500 font-bold sm:text-sm">S/.</span>
        </div>
        <input type="number"
               id="montoDeuda"
               name="montoDeuda"
               [(ngModel)]="formData.montoDeuda"
               (input)="clearError('montoDeuda')"
               min="0.10"
               step="0.10"
               required
               placeholder="0.00"
               class="w-full pl-10 pr-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all font-mono text-lg"
               [ngClass]="errors.montoDeuda ? 'border-red-500' : 'border-gray-300'" />
      </div>

      <p *ngIf="errors.montoDeuda" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
        <app-icon name="circle-x" [size]="14"></app-icon>
        {{ errors.montoDeuda }}
      </p>
      <p *ngIf="!errors.montoDeuda" class="mt-1.5 text-xs text-gray-400">
        Ingrese el monto total pendiente reportado por Cuentas Pacientes.
      </p>
    </div>

    <div class="flex items-center gap-3 pt-4 border-t border-gray-200">

      <button type="button"
              (click)="cancelar()"
              [disabled]="isSubmitting"
              class="flex-1 px-4 py-2.5 border-2 border-gray-300 text-gray-700 font-semibold rounded-lg
               hover:bg-gray-50 hover:border-gray-400 transition-all
               disabled:opacity-50 disabled:cursor-not-allowed
               flex items-center justify-center gap-2">
        <app-icon name="x" [size]="18"></app-icon>
        Cancelar
      </button>

      <button type="submit"
              [disabled]="!puedeRegistrar"
              class="flex-1 px-4 py-2.5 bg-hospital-cyan text-white font-semibold rounded-lg
               hover:bg-cyan-700 shadow-md hover:shadow-lg transition-all
               disabled:opacity-50 disabled:cursor-not-allowed
               flex items-center justify-center gap-2">
        <app-icon [name]="isSubmitting ? 'loader' : 'circle-check'"
                  [size]="18"
                  [class.animate-spin]="isSubmitting"></app-icon>
        <span>{{ isSubmitting ? 'Procesando...' : 'Registrar' }}</span>
      </button>

    </div>

  </form>
</div>

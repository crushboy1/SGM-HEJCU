<div class="w-full">
  <label class="block text-sm font-semibold text-gray-700 mb-2">
    {{ label }}
  </label>

  <div class="relative flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer transition-all duration-200 bg-gray-50 hover:bg-gray-100"
       [ngClass]="{
      'border-hospital-cyan bg-cyan-50': isDragging,
      'border-gray-300': !isDragging && !errorMessage && !selectedFile,
      'border-red-400 bg-red-50': errorMessage,
      'border-green-400 bg-green-50': selectedFile || currentFileName
    }"
       (dragover)="onDragOver($event)"
       (dragleave)="onDragLeave($event)"
       (drop)="onDrop($event)"
       (click)="fileInput.click()">

    <input #fileInput
           type="file"
           accept="application/pdf"
           class="hidden"
           (change)="onFileSelected($event)"
           [disabled]="disabled" />

    <div class="flex flex-col items-center justify-center pt-5 pb-6 text-center px-4">

      <ng-container *ngIf="selectedFile || currentFileName; else emptyState">
        <app-icon name="file-text" [size]="32" class="text-hospital-green mb-2"></app-icon>
        <p class="text-sm font-medium text-gray-900 truncate max-w-full px-2">
          {{ fileNameDisplay }}
        </p>
        <p *ngIf="selectedFile" class="text-xs text-gray-500 mt-1">
          {{ fileSizeDisplay }}
        </p>

        <button *ngIf="!disabled"
                (click)="removeFile($event)"
                class="absolute top-2 right-2 p-1 bg-white rounded-full shadow-sm hover:bg-red-50 text-gray-400 hover:text-red-500 transition-colors"
                title="Quitar archivo">
          <app-icon name="x" [size]="16"></app-icon>
        </button>
      </ng-container>

      <ng-template #emptyState>
        <ng-container *ngIf="!errorMessage; else errorState">
          <app-icon name="upload" [size]="28" class="text-gray-400 mb-2"></app-icon>
          <p class="text-sm text-gray-500">
            <span class="font-semibold text-hospital-cyan">Haga clic</span> o arrastre el PDF aquí
          </p>
          <p class="text-xs text-gray-400 mt-1">
            PDF (máx. {{ MAX_SIZE_MB }}MB)
          </p>
        </ng-container>
      </ng-template>

      <ng-template #errorState>
        <app-icon name="alert-circle" [size]="28" class="text-red-500 mb-2"></app-icon>
        <p class="text-sm font-medium text-red-600 px-2">
          {{ errorMessage }}
        </p>
        <p class="text-xs text-red-400 mt-1">Intente nuevamente</p>
      </ng-template>

    </div>
  </div>
</div>

<div class="formulario-acta-retiro bg-white rounded-xl shadow-md border border-gray-200 p-6">

  <!-- ===================================================================
       HEADER DEL FORMULARIO
       =================================================================== -->
  <div class="flex items-center gap-3 mb-6 pb-4 border-b border-gray-200">
    <div class="p-3 bg-cyan-100 rounded-xl">
      <app-icon name="file-text" [size]="24" class="text-hospital-cyan"></app-icon>
    </div>
    <div>
      <h3 class="text-lg font-bold text-gray-800">{{ tituloFormulario }}</h3>
      <p class="text-sm text-gray-500">
        Complete los datos según el tipo de salida
      </p>
    </div>
  </div>

  <form (ngSubmit)="crear()" class="space-y-6">

    <!-- ===================================================================
         SECCIÓN 1: DATOS DEL FALLECIDO (Solo Lectura)
         =================================================================== -->
    <div class="space-y-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
      <h4 class="font-semibold text-gray-800 flex items-center gap-2 mb-3">
        <app-icon name="user" [size]="16" class="text-gray-600"></app-icon>
        <span>Datos del Fallecido</span>
      </h4>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Nombre Completo -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            Nombre Completo
          </label>
          <input type="text"
                 [value]="formData.nombreCompletoPaciente"
                 readonly
                 class="w-full px-4 py-2.5 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed text-gray-700">
        </div>

        <!-- HC -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            <app-icon name="hash" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
            Historia Clínica
          </label>
          <input type="text"
                 [value]="formData.hc"
                 readonly
                 class="w-full px-4 py-2.5 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed font-mono text-gray-700">
        </div>

        <!-- DNI Paciente -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            <app-icon name="credit-card" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
            DNI
          </label>
          <input type="text"
                 [value]="formData.dniPaciente"
                 readonly
                 class="w-full px-4 py-2.5 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed font-mono text-gray-700">
        </div>

        <!-- Servicio -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            <app-icon name="building-2" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
            Servicio de Fallecimiento
          </label>
          <input type="text"
                 [value]="formData.servicioFallecimiento"
                 readonly
                 class="w-full px-4 py-2.5 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed text-gray-700">
        </div>

      </div>
    </div>

    <!-- ===================================================================
         SECCIÓN 2: MÉDICO CERTIFICANTE (READONLY)
         =================================================================== -->
    <div class="space-y-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
      <h4 class="font-semibold text-gray-800 flex items-center gap-2 mb-3">
        <app-icon name="user" [size]="16" class="text-gray-600"></app-icon>
        <span>Médico Certificante</span>
      </h4>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">

        <!-- Nombre Médico -->
        <div class="md:col-span-2">
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            Nombre Completo
          </label>
          <input type="text"
                 [value]="formData.nombreMedicoCertificante || 'No registrado'"
                 readonly
                 class="w-full px-4 py-2.5 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed text-gray-700">
        </div>

        <!-- CMP -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            CMP
          </label>
          <input type="text"
                 [value]="formData.cmpMedicoCertificante || 'N/A'"
                 readonly
                 class="w-full px-4 py-2.5 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed font-mono text-gray-700">
        </div>

      </div>
    </div>

    <!-- ===================================================================
         SECCIÓN 3: TIPO DE SALIDA
         =================================================================== -->
    <div>
      <h4 class="font-semibold text-gray-800 flex items-center gap-2 mb-3">
        <app-icon name="info" [size]="16" class="text-hospital-cyan"></app-icon>
        <span>Tipo de Salida</span>
        <span class="text-red-500">*</span>
      </h4>

      <div class="flex gap-4">
        <label class="flex items-center gap-2 cursor-pointer px-4 py-3 border-2 rounded-lg transition-all"
               [ngClass]="formData.tipoSalida === 'Familiar' ? 'border-hospital-cyan bg-cyan-50' : 'border-gray-300 hover:border-gray-400'">
          <input type="radio"
                 name="tipoSalida"
                 value="Familiar"
                 [(ngModel)]="formData.tipoSalida"
                 class="w-4 h-4 text-hospital-cyan">
          <span class="font-medium text-gray-700">Retiro por Familiar</span>
        </label>

        <label class="flex items-center gap-2 cursor-pointer px-4 py-3 border-2 rounded-lg transition-all"
               [ngClass]="formData.tipoSalida === 'AutoridadLegal' ? 'border-hospital-cyan bg-cyan-50' : 'border-gray-300 hover:border-gray-400'">
          <input type="radio"
                 name="tipoSalida"
                 value="AutoridadLegal"
                 [(ngModel)]="formData.tipoSalida"
                 class="w-4 h-4 text-hospital-cyan">
          <span class="font-medium text-gray-700">Autoridad Legal</span>
        </label>
      </div>
    </div>

    <!-- ===================================================================
         SECCIÓN 4: CERTIFICADO/OFICIO
         =================================================================== -->
    <div class="space-y-4">

      <!-- SINADEF -->
      <div *ngIf="formData.tipoSalida === 'Familiar'">
        <label for="numeroCertificadoDefuncion" class="block text-sm font-semibold text-gray-700 mb-2">
          <app-icon name="file-badge" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
          N° Certificado de Defunción SINADEF *
        </label>
        <input type="text"
               id="numeroCertificadoDefuncion"
               name="numeroCertificadoDefuncion"
               [(ngModel)]="formData.numeroCertificadoDefuncion"
               (input)="onCertificadoSINADEFChange($event.target.value)"
               placeholder="Ej: 2025-12345678"
               maxlength="50"
               class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all font-mono"
               [ngClass]="errors['numeroCertificadoDefuncion'] ? 'border-red-500' : 'border-gray-300'">

        <p *ngIf="errors['numeroCertificadoDefuncion']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
          <app-icon name="circle-x" [size]="14"></app-icon>
          {{ errors['numeroCertificadoDefuncion'] }}
        </p>
      </div>

      <!-- OFICIO LEGAL -->
      <div *ngIf="formData.tipoSalida === 'AutoridadLegal'">
        <label for="numeroOficioLegal" class="block text-sm font-semibold text-gray-700 mb-2">
          <app-icon name="file-text" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
          N° de Oficio Legal *
        </label>
        <input type="text"
               id="numeroOficioLegal"
               name="numeroOficioLegal"
               [(ngModel)]="formData.numeroOficioLegal"
               (input)="onOficioLegalChange($event.target.value)"
               placeholder="Ej: OF-2025-001234"
               maxlength="50"
               class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all font-mono"
               [ngClass]="errors['numeroOficioLegal'] ? 'border-red-500' : 'border-gray-300'">

        <p *ngIf="errors['numeroOficioLegal']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
          <app-icon name="circle-x" [size]="14"></app-icon>
          {{ errors['numeroOficioLegal'] }}
        </p>
      </div>

    </div>

    <!-- ===================================================================
         SECCIÓN 5: JEFE DE GUARDIA
         =================================================================== -->
    <div class="space-y-4">
      <h4 class="font-semibold text-gray-800 flex items-center gap-2">
        <app-icon name="shield" [size]="16" class="text-hospital-cyan"></app-icon>
        <span>Jefe de Guardia Autorizante</span>
        <span class="text-red-500">*</span>
      </h4>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Nombre Jefe de Guardia -->
        <div>
          <label for="nombreJefeGuardia" class="block text-sm font-semibold text-gray-700 mb-2">
            Nombre Completo *
          </label>
          <input type="text"
                 id="nombreJefeGuardia"
                 name="nombreJefeGuardia"
                 [(ngModel)]="formData.nombreJefeGuardia"
                 (input)="clearError('nombreJefeGuardia')"
                 placeholder="Ej: Dr. Juan Pérez García"
                 maxlength="200"
                 required
                 class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all"
                 [ngClass]="errors['nombreJefeGuardia'] ? 'border-red-500' : 'border-gray-300'">

          <p *ngIf="errors['nombreJefeGuardia']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['nombreJefeGuardia'] }}
          </p>
        </div>

        <!-- CMP Jefe de Guardia -->
        <div>
          <label for="cmpJefeGuardia" class="block text-sm font-semibold text-gray-700 mb-2">
            <app-icon name="hash" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
            CMP *
          </label>
          <input type="text"
                 id="cmpJefeGuardia"
                 name="cmpJefeGuardia"
                 [(ngModel)]="formData.cmpJefeGuardia"
                 (input)="clearError('cmpJefeGuardia')"
                 placeholder="000000"
                 maxlength="6"
                 required
                 class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all font-mono"
                 [ngClass]="errors['cmpJefeGuardia'] ? 'border-red-500' : 'border-gray-300'">

          <p *ngIf="errors['cmpJefeGuardia']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['cmpJefeGuardia'] }}
          </p>
          <p *ngIf="!errors['cmpJefeGuardia']" class="mt-1.5 text-xs text-gray-400">
            6 dígitos numéricos
          </p>
        </div>

      </div>
    </div>

    <!-- ===================================================================
         SECCIÓN 6A: FAMILIAR RESPONSABLE
         =================================================================== -->
    <div *ngIf="formData.tipoSalida === 'Familiar'" class="space-y-4">
      <h4 class="font-semibold text-gray-800 flex items-center gap-2">
        <app-icon name="users" [size]="16" class="text-hospital-cyan"></app-icon>
        <span>Familiar Responsable del Retiro</span>
        <span class="text-red-500">*</span>
      </h4>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Nombre Familiar -->
        <div>
          <label for="nombreFamiliar" class="block text-sm font-semibold text-gray-700 mb-2">
            Nombre Completo *
          </label>
          <input type="text"
                 id="nombreFamiliar"
                 name="nombreFamiliar"
                 [(ngModel)]="formData.nombreFamiliar"
                 (input)="clearError('nombreFamiliar')"
                 placeholder="Apellido Paterno Apellido Materno, Nombres"
                 maxlength="200"
                 class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all"
                 [ngClass]="errors['nombreFamiliar'] ? 'border-red-500' : 'border-gray-300'">

          <p *ngIf="errors['nombreFamiliar']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['nombreFamiliar'] }}
          </p>
          <p *ngIf="!errors['nombreFamiliar']" class="mt-1.5 text-xs text-gray-400">
            Formato: APELLIDOS, Nombres
          </p>
        </div>

        <!-- Tipo de Documento Familiar -->
        <div>
          <label for="tipoDocumentoFamiliar" class="block text-sm font-semibold text-gray-700 mb-2">
            Tipo de Documento *
          </label>
          <select id="tipoDocumentoFamiliar"
                  name="tipoDocumentoFamiliar"
                  [(ngModel)]="formData.tipoDocumentoFamiliar"
                  (change)="clearError('tipoDocumentoFamiliar')"
                  class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all bg-white"
                  [ngClass]="errors['tipoDocumentoFamiliar'] ? 'border-red-500' : 'border-gray-300'">
            <option [value]="tipo.value" *ngFor="let tipo of tiposDocumentoFamiliar">
              {{ tipo.label }}
            </option>
          </select>

          <p *ngIf="errors['tipoDocumentoFamiliar']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['tipoDocumentoFamiliar'] }}
          </p>
        </div>

        <!-- Número de Documento Familiar -->
        <div>
          <label for="dniFamiliar" class="block text-sm font-semibold text-gray-700 mb-2">
            <app-icon name="credit-card" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
            Número de Documento *
          </label>
          <input type="text"
                 id="dniFamiliar"
                 name="dniFamiliar"
                 [(ngModel)]="formData.dniFamiliar"
                 (input)="clearError('dniFamiliar')"
                 [placeholder]="obtenerPlaceholderDocumento(formData.tipoDocumentoFamiliar)"
                 maxlength="20"
                 class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all font-mono"
                 [ngClass]="errors['dniFamiliar'] ? 'border-red-500' : 'border-gray-300'">

          <p *ngIf="errors['dniFamiliar']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['dniFamiliar'] }}
          </p>
        </div>

        <!-- Parentesco -->
        <div>
          <label for="parentesco" class="block text-sm font-semibold text-gray-700 mb-2">
            Parentesco *
          </label>
          <select id="parentesco"
                  name="parentesco"
                  [(ngModel)]="formData.parentesco"
                  (change)="clearError('parentesco')"
                  class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all bg-white"
                  [ngClass]="errors['parentesco'] ? 'border-red-500' : 'border-gray-300'">
            <option value="">Seleccione parentesco</option>
            <option value="Cónyuge">Cónyuge</option>
            <option value="Conviviente">Conviviente</option>
            <option value="Hijo/a">Hijo/a</option>
            <option value="Padre/Madre">Padre/Madre</option>
            <option value="Hermano/a">Hermano/a</option>
            <option value="Tío/a">Tío/a</option>
            <option value="Sobrino/a">Sobrino/a</option>
            <option value="Primo/a">Primo/a</option>
            <option value="Otro">Otro</option>
          </select>

          <p *ngIf="errors['parentesco']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['parentesco'] }}
          </p>
        </div>

        <!-- Teléfono -->
        <div class="md:col-span-2">
          <label for="telefonoFamiliar" class="block text-sm font-semibold text-gray-700 mb-2">
            Teléfono de Contacto
          </label>
          <input type="text"
                 id="telefonoFamiliar"
                 name="telefonoFamiliar"
                 [(ngModel)]="formData.telefonoFamiliar"
                 placeholder="999999999"
                 maxlength="9"
                 class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all font-mono">

          <p class="mt-1.5 text-xs text-gray-400">
            9 dígitos numéricos (opcional)
          </p>
        </div>

      </div>

    </div>

    <!-- ===================================================================
         SECCIÓN 6B: AUTORIDAD LEGAL
         =================================================================== -->
    <div *ngIf="formData.tipoSalida === 'AutoridadLegal'" class="space-y-4">
      <h4 class="font-semibold text-gray-800 flex items-center gap-2">
        <app-icon name="shield" [size]="16" class="text-orange-600"></app-icon>
        <span>Datos de la Autoridad Legal</span>
        <span class="text-red-500">*</span>
      </h4>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Tipo de Autoridad -->
        <div>
          <label for="tipoAutoridad" class="block text-sm font-semibold text-gray-700 mb-2">
            Tipo de Autoridad *
          </label>
          <select id="tipoAutoridad"
                  name="tipoAutoridad"
                  [(ngModel)]="formData.tipoAutoridad"
                  (change)="clearError('tipoAutoridad')"
                  class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all bg-white"
                  [ngClass]="errors['tipoAutoridad'] ? 'border-red-500' : 'border-gray-300'">
            <option [value]="tipo.value" *ngFor="let tipo of tiposAutoridad">
              {{ tipo.label }}
            </option>
          </select>

          <p *ngIf="errors['tipoAutoridad']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['tipoAutoridad'] }}
          </p>
        </div>

        <!-- Tipo de Documento Autoridad -->
        <div>
          <label for="tipoDocumentoAutoridad" class="block text-sm font-semibold text-gray-700 mb-2">
            Tipo de Documento *
          </label>
          <select id="tipoDocumentoAutoridad"
                  name="tipoDocumentoAutoridad"
                  [(ngModel)]="formData.tipoDocumentoAutoridad"
                  (change)="clearError('tipoDocumentoAutoridad')"
                  class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all bg-white"
                  [ngClass]="errors['tipoDocumentoAutoridad'] ? 'border-red-500' : 'border-gray-300'">
            <option [value]="tipo.value" *ngFor="let tipo of tiposDocumento">
              {{ tipo.label }}
            </option>
          </select>

          <p *ngIf="errors['tipoDocumentoAutoridad']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['tipoDocumentoAutoridad'] }}
          </p>
        </div>

        <!-- Nombre Autoridad -->
        <div class="md:col-span-2">
          <label for="nombreAutoridad" class="block text-sm font-semibold text-gray-700 mb-2">
            Nombre Completo *
          </label>
          <input type="text"
                 id="nombreAutoridad"
                 name="nombreAutoridad"
                 [(ngModel)]="formData.nombreAutoridad"
                 (input)="clearError('nombreAutoridad')"
                 placeholder="Apellido Paterno Apellido Materno, Nombres"
                 maxlength="200"
                 class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all"
                 [ngClass]="errors['nombreAutoridad'] ? 'border-red-500' : 'border-gray-300'">

          <p *ngIf="errors['nombreAutoridad']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['nombreAutoridad'] }}
          </p>
          <p *ngIf="!errors['nombreAutoridad']" class="mt-1.5 text-xs text-gray-400">
            Formato: APELLIDOS, Nombres
          </p>
        </div>

        <!-- Documento de Identidad Autoridad -->
        <div>
          <label for="documentoAutoridad" class="block text-sm font-semibold text-gray-700 mb-2">
            <app-icon name="credit-card" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
            Número de Documento *
          </label>
          <input type="text"
                 id="documentoAutoridad"
                 name="documentoAutoridad"
                 [(ngModel)]="formData.documentoAutoridad"
                 (input)="clearError('documentoAutoridad')"
                 [placeholder]="obtenerPlaceholderDocumento(formData.tipoDocumentoAutoridad)"
                 maxlength="20"
                 class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all font-mono"
                 [ngClass]="errors['documentoAutoridad'] ? 'border-red-500' : 'border-gray-300'">

          <p *ngIf="errors['documentoAutoridad']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['documentoAutoridad'] }}
          </p>
        </div>

        <!-- Cargo -->
        <div>
          <label for="cargoAutoridad" class="block text-sm font-semibold text-gray-700 mb-2">
            Cargo *
          </label>
          <input type="text"
                 id="cargoAutoridad"
                 name="cargoAutoridad"
                 [(ngModel)]="formData.cargoAutoridad"
                 (input)="clearError('cargoAutoridad')"
                 placeholder="Ej: Sub Oficial, Fiscal Provincial, Médico Legista"
                 maxlength="100"
                 class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all"
                 [ngClass]="errors['cargoAutoridad'] ? 'border-red-500' : 'border-gray-300'">

          <p *ngIf="errors['cargoAutoridad']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['cargoAutoridad'] }}
          </p>
        </div>

        <!-- Institución -->
        <div>
          <label for="institucionAutoridad" class="block text-sm font-semibold text-gray-700 mb-2">
            Institución *
          </label>
          <input type="text"
                 id="institucionAutoridad"
                 name="institucionAutoridad"
                 [(ngModel)]="formData.institucionAutoridad"
                 (input)="clearError('institucionAutoridad')"
                 placeholder="Ej: Comisaría San Antonio - Miraflores"
                 maxlength="200"
                 class="w-full px-4 py-2.5 border rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all"
                 [ngClass]="errors['institucionAutoridad'] ? 'border-red-500' : 'border-gray-300'">

          <p *ngIf="errors['institucionAutoridad']" class="mt-1.5 text-sm text-red-600 flex items-center gap-1">
            <app-icon name="circle-x" [size]="14"></app-icon>
            {{ errors['institucionAutoridad'] }}
          </p>
        </div>

        <!-- Placa Vehículo (Opcional) -->
        <div>
          <label for="placaVehiculoAutoridad" class="block text-sm font-semibold text-gray-700 mb-2">
            Placa del Vehículo
          </label>
          <input type="text"
                 id="placaVehiculoAutoridad"
                 name="placaVehiculoAutoridad"
                 [(ngModel)]="formData.placaVehiculoAutoridad"
                 placeholder="ABC-123"
                 maxlength="10"
                 class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all font-mono uppercase">

          <p class="mt-1.5 text-xs text-gray-400">
            Placa del vehículo de la autoridad (opcional)
          </p>
        </div>

        <!-- Teléfono Autoridad -->
        <div>
          <label for="telefonoAutoridad" class="block text-sm font-semibold text-gray-700 mb-2">
            Teléfono de Contacto
          </label>
          <input type="text"
                 id="telefonoAutoridad"
                 name="telefonoAutoridad"
                 [(ngModel)]="formData.telefonoAutoridad"
                 placeholder="999 999 999"
                 maxlength="9"
                 class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all font-mono">

          <p class="mt-1.5 text-xs text-gray-400">
            9 dígitos numéricos (opcional)
          </p>
        </div>

      </div>
    </div>

    <!-- ===================================================================
         SECCIÓN 7: DATOS ADICIONALES (OPCIONAL - SIEMPRE VISIBLE)
         =================================================================== -->
    <div class="space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
      <h4 class="font-semibold text-gray-800 flex items-center gap-2">
        <app-icon name="info" [size]="16" class="text-blue-600"></app-icon>
        <span>Información Adicional</span>
        <span class="text-xs font-normal text-gray-500">(opcional)</span>
      </h4>

      <div class="grid grid-cols-1 gap-4">

        <!-- Destino del Cuerpo -->
        <div>
          <label for="destinoCuerpo" class="block text-sm font-semibold text-gray-700 mb-2">
            <app-icon name="map-pin" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
            Destino del Cuerpo
          </label>
          <input type="text"
                 id="destinoCuerpo"
                 name="destinoCuerpo"
                 [(ngModel)]="formData.destinoCuerpo"
                 placeholder="Ej: Cementerio Parque del Recuerdo, Morgue Central"
                 maxlength="200"
                 class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all">
          <p class="mt-1.5 text-xs text-gray-400">
            Cementerio, funeraria o destino final del cuerpo
          </p>
        </div>

        <!-- Observaciones -->
        <div>
          <label for="observaciones" class="block text-sm font-semibold text-gray-700 mb-2">
            <app-icon name="file-text" [size]="14" class="inline-block mr-1 text-gray-400"></app-icon>
            Observaciones
          </label>
          <textarea id="observaciones"
                    name="observaciones"
                    [(ngModel)]="formData.observaciones"
                    placeholder="Información adicional relevante..."
                    rows="3"
                    maxlength="500"
                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-hospital-cyan focus:border-hospital-cyan transition-all resize-none"></textarea>
          <p class="mt-1.5 text-xs text-gray-400">
            Máximo 500 caracteres
          </p>
        </div>

      </div>
    </div>

    <!-- ===================================================================
         FOOTER: BOTONES DE ACCIÓN
         =================================================================== -->
    <div class="flex items-center gap-3 pt-4 border-t border-gray-200">

      <!-- Botón Cancelar -->
      <button type="button"
              (click)="cancelarFormulario()"
              [disabled]="isSubmitting"
              class="flex-1 px-4 py-2.5 border-2 border-gray-300 text-gray-700 font-semibold rounded-lg
                     hover:bg-gray-50 hover:border-gray-400 transition-all
                     disabled:opacity-50 disabled:cursor-not-allowed
                     flex items-center justify-center gap-2">
        <app-icon name="x" [size]="18"></app-icon>
        Cancelar
      </button>

      <!-- Botón Crear Acta -->
      <button type="submit"
              [disabled]="!puedeCrear"
              class="flex-1 px-4 py-2.5 bg-hospital-cyan text-white font-semibold rounded-lg
                     hover:bg-cyan-700 shadow-md hover:shadow-lg transition-all
                     disabled:opacity-50 disabled:cursor-not-allowed
                     flex items-center justify-center gap-2">
        <app-icon [name]="isSubmitting ? 'loader' : 'file-check'"
                  [size]="18"
                  [class.animate-spin]="isSubmitting"></app-icon>
        <span>{{ isSubmitting ? 'Creando Acta...' : 'Crear Acta de Retiro' }}</span>
      </button>

    </div>

  </form>

</div>
